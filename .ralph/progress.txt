## Completed Tasks

### Create service container and bootstrap infrastructure
- Created src/lib/services/container.ts with ServiceContainer interface
- Added ConfigService and PrdService interfaces
- Implemented initializeServices(), getServices(), resetServices(), isInitialized()
- Added convenience accessors getConfigService() and getPrdService()
- Created src/lib/services/bootstrap.ts with bootstrapServices() and bootstrapTestServices()
- Updated src/lib/services/index.ts to export all container and bootstrap functions
- Updated src/index.tsx to call bootstrapServices() at application startup
- Verified with bun check and build

### Migrate SessionMemoryService to new architecture
- Created src/lib/services/session-memory/ directory with self-contained service files
- Created types.ts with SessionMemory, SessionMemoryStats, SessionMemoryService interfaces and SESSION_MEMORY_CONSTANTS
- Created validation.ts with isSessionMemory type guard
- Created formatters.ts with formatForPrompt, formatForTask, and exportAsMarkdown functions
- Created implementation.ts with createSessionMemoryService factory function using closure-based caching
- Updated container.ts to add SessionMemoryService to ServiceContainer and getSessionMemoryService() accessor
- Updated bootstrap.ts to create SessionMemoryService instance and add mock for tests
- Updated index.ts to re-export SessionMemory, SessionMemoryService, SessionMemoryStats types
- Updated all consumers (prompt.ts, orchestrator.ts, LearningHandler.ts, useSlashCommands.ts, MemoryView.tsx, memory.ts CLI command)
- Updated test files to use bootstrapTestServices() with real or mock SessionMemoryService
- Removed SessionMemory from src/types/session.types.ts
- Removed isSessionMemory from src/lib/type-guards.ts
- Re-exported SessionMemory types from src/types/index.ts via services
- Deleted src/lib/session-memory.ts
- All 414 tests pass

### Migrate SessionService to new architecture
- Created src/lib/services/session/ directory with self-contained service files
- Created types.ts with Session, SessionStatus, SessionStatistics, IterationTiming interfaces and SessionService interface
- Created validation.ts with isSession, isSessionStatus type guards
- Created implementation.ts with createSessionService factory function using closure-based caching
- Updated container.ts to add SessionService to ServiceContainer and getSessionService() accessor
- Updated bootstrap.ts to create SessionService instance and add mock for tests
- Updated index.ts to re-export Session, SessionService, SessionStatus types
- Updated all consumers (orchestrator.ts, appStore.ts, daemon.ts, CLI commands, useSlashCommands.ts, integrity.ts)
- Updated test files to use the new service
- Removed Session, SessionStatus, SessionStatistics, IterationTiming from src/types/session.types.ts
- Removed isSession, isSessionStatus from src/lib/type-guards.ts
- Re-exported Session types from src/types/index.ts via services
- Deleted src/lib/session.ts
- All 414 tests pass

### Migrate ConfigService to new architecture
- Created src/lib/services/config/ directory with self-contained service files
- Created types.ts with RalphConfig, AgentType, NotificationConfig, MemoryConfig, VerificationConfig, ConfigValidationError, ConfigValidationResult interfaces and ConfigService interface
- Created validation.ts with isRalphConfig, isPartialRalphConfig, validateConfig type guards and validation functions
- Created constants.ts with DEFAULTS, CONFIG_DEFAULTS, DEFAULT_CONFIG, VALID_AGENTS, AGENT_COMMANDS and default value constants
- Created formatter.ts with formatValidationErrors, formatMs, formatBytes, getConfigSummary functions
- Created implementation.ts with createConfigService factory function using closure-based caching, plus applyDefaults, getAgentCommand, getGlobalConfigPath, getProjectConfigPath exports
- Updated container.ts to import ConfigService from ./config/types.ts
- Updated bootstrap.ts to use createConfigService() instead of singleton
- Updated index.ts to re-export all config types, constants, formatters, and validation functions
- Updated src/lib/config.ts facade to re-export from new service location
- Updated src/types/index.ts to export config types from services
- Removed RalphConfig, AgentType, NotificationConfig, MemoryConfig, VerificationConfig, ConfigValidationError, ConfigValidationResult from src/types/config.types.ts
- Removed isRalphConfig, isPartialRalphConfig from src/lib/type-guards.ts
- Updated src/types/session.types.ts to import AgentType from new location
- Updated src/lib/constants/defaults.ts to re-export from config service
- Updated src/lib/constants/index.ts to re-export from config service
- Deleted src/lib/services/ConfigService.ts (old singleton)
- Deleted src/lib/config/ directory (old config module)
- Deleted src/lib/constants/config.ts (migrated to service)
- All 414 tests pass

### Migrate PrdService to new architecture
- Created src/lib/services/prd/ directory with self-contained service files
- Created types.ts with Prd, PrdTask, LoadPrdResult, DecompositionSubtask, DecompositionRequest, TaskWithIndex, CanWorkResult interfaces and PrdService interface
- Created validation.ts with isPrd, isPrdTask type guards
- Created implementation.ts with createPrdService factory function using closure-based caching
- Updated container.ts to import PrdService from ./prd/types.ts
- Updated bootstrap.ts to use createPrdService() instead of singleton
- Updated index.ts to re-export all PRD types, validation functions
- Updated src/lib/prd.ts facade to re-export from new service location
- Updated src/types/index.ts to export PRD types from services
- Removed Prd, PrdTask, LoadPrdResult, DecompositionSubtask, DecompositionRequest from src/types/prd.types.ts
- Removed isPrd, isPrdTask from src/lib/type-guards.ts
- Updated src/lib/integrity.ts to import isPrd from new location
- Updated InitWizard.tsx and AddTaskWizard.tsx to import isPrd/isPrdTask from services
- Updated test files to use bootstrapTestServices() with real PrdService
- Deleted src/types/prd.types.ts
- Deleted src/lib/services/PrdService.ts (old singleton)
- All 414 tests pass

### Migrate GuardrailsService to new architecture
- Created src/lib/services/guardrails/ directory with self-contained service files
- Created types.ts with PromptGuardrail, GuardrailTrigger, GuardrailCategory, AddGuardrailOptions, GuardrailsFile interfaces and GuardrailsService interface
- Created validation.ts with isPromptGuardrail, isGuardrailsFile type guards
- Created defaults.ts with createDefaultGuardrails function
- Created formatters.ts with formatGuardrailsForPrompt function
- Created implementation.ts with createGuardrailsService factory function using closure-based caching
- Updated container.ts to add GuardrailsService to ServiceContainer and getGuardrailsService() accessor
- Updated bootstrap.ts to create GuardrailsService instance and add mock for tests
- Updated index.ts to re-export all guardrails types, constants, formatters, and validation functions
- Updated all consumers (prompt.ts, guardrails.ts CLI command, useSlashCommands.ts, GuardrailsView.tsx, AnalyzeView.tsx)
- Updated test files to use bootstrapTestServices() with real GuardrailsService
- Removed PromptGuardrail, GuardrailTrigger, GuardrailCategory from src/types/config.types.ts
- Removed isGuardrailsFile from src/lib/type-guards.ts
- Re-exported guardrails types from src/types/index.ts via services
- Updated src/lib/constants/defaults.ts to re-export createDefaultGuardrails from service
- Deleted src/lib/guardrails.ts
- All 414 tests pass

### Clean up legacy files and types after service migration
- Verified src/types/session.types.ts contains only IterationLog and FailureHistory types (cross-cutting, not migrated)
- Verified src/types/config.types.ts contains only CheckResult and VerificationResult (verification types, not migrated)
- Confirmed src/types/prd.types.ts was already deleted during PrdService migration
- Verified src/lib/type-guards.ts contains only guards for non-migrated types (IterationLog, FailureHistory, StreamJsonMessage)
- Verified src/types/index.ts properly exports service types from @/lib/services/index.ts and cross-cutting types
- Confirmed src/lib/config.ts facade is intentionally kept for backward compatibility (15+ files import from it)
- Confirmed src/lib/config/ directory was already deleted during ConfigService migration
- Confirmed src/lib/constants/config.ts was already deleted during ConfigService migration
- Verified src/lib/constants/index.ts properly re-exports from config service constants
- Build passes, all 414 tests pass
